HTTPS 프로토콜이란 무엇인가?

 

HTTPS는 HTTP 프로토콜을 진행하는 도중, 애플리케이션 계층과 전송 계층 사이에 신뢰 계층인 SSL/TLS 계층을 넣은 신뢰할 수 있는 HTTP 요청을 말합니다. 이를 통해 통신을 암호화합니다.

 

SSL/TLS란 무엇인가??

 

SSL/TLS는 전송 계층에서 보안을 제공하는 프로토콜입니다. 클라이언트와 서버가 통신할 때, SSL/TLS를 통해 제 3자가 메시지를 도청하거나 변조하지 못하도록 합니다.

예를 들어, 해커가 서버인 척하며 사용자 정보를 가로채려고 할 때, SSL/TLS를 통해 네트워크 상의 인터셉터를 방지할 수 있습니다.

SSL/TLS는 보안 세션을 기반으로 데이터를 암호화하며 보안 세션이 만들어질 때 인증 메커니즘, 키 교환 알고리즘, 해싱 알고리즘이 사용됩니다.

 

보안 세션이란?

→ 보안이 시작되고 끝나는 동안 유지되는 기간을 뜻한다.

SSL과 TLS의 차이는?

→ SSL(Secure Sockets Layer)와 TLS(Transport Layer Security)는 둘 다 암호화 프로토콜로서, 데이터가 인터넷을 통해 안전하게 전송되도록 하는 역할을 합니다. 그러나 이 둘은 개발 및 배포 시기와 지원하는 암호화 알고리즘 등에 차이가 있습니다.

SSL: Netscape에서 처음 개발되었고, 웹 브라우저와 서버 사이의 데이터를 암호화하고 인증하는 데 사용되었습니다. SSL은 버전 1.0, 2.0, 3.0까지 발표되었지만, 버전 1.0은 내부적으로 사용되다가 공개되지 않았고, 버전 2.0은 일반에게 공개되었으나 보안 결함이 발견되어 대체되었습니다. SSL 3.0은 1996년에 발표되었지만, 이후의 보안 이슈로 인해 대체되었습니다.
TLS: TLS는 SSL 3.0의 후속 버전으로, 보안 표준화 작업을 이어받아 1999년에 IETF(Internet Engineering Task Force)에 의해 처음으로 발표되었습니다. 그 이후로 여러 버전의 개선이 이루어져 왔고, 2021년까지 TLS 1.0, 1.1, 1.2, 1.3이 발표되었습니다.
TLS는 SSL에 비해 더 강력한 보안 기능을 제공하며, 더 다양한 암호화 알고리즘을 지원합니다. 또한, 각 버전마다 보안 개선 사항이 있으며, 이전 버전의 알려진 보안 결함을 수정하거나 대응합니다.

일반적으로, TLS는 SSL보다 업데이트된 보안 기능을 제공하므로 현대의 인터넷 보안에서는 TLS가 더욱 선호됩니다. 이 때문에 현재 많은 웹사이트와 브라우저는 SSL을 완전히 중단하고 TLS만을 지원하고 있습니다. 하지만 많은 사람들이 여전히 이 두 용어를 혼용하여 사용하며, "SSL"이라는 용어는 종종 SSL과 TLS를 포괄하는 일반적인 용어로 사용됩니다.

 

HTTPS 암호화 과정은 어떻게 되는가? (SSL 핸드셰이크를 통해)

 

→ 클라이언트가 서버에게 클라이언트 헬로 메시지 전달 및 사이퍼 슈트 전달

→ 서버가 클라이언트에게 서버 헬로 메시지 전달 및 전달 받은 사이퍼 슈트 내의 암호화 알고리즘 리스트를 제공할 수 있는지 확인

→ 제공할 수 있다면 서버에서 클라이언트로 인증서를 보내는 인증 메커니즘 시작

→ 이후 해싱 알고리즘 등으로 암호화된 데이터 송수신

 

SSL/TLS 핸드셰이크는 클라이언트(대개 웹 브라우저)와 서버 간에 보안 연결을 초기화하는 과정입니다. 이 과정에서 클라이언트와 서버는 암호화 방식을 협상하고, 서버는 자신의 신원을 증명합니다.

클라이언트는 서버에게 "클라이언트 헬로" 메시지를 보내면서 이 과정을 시작합니다. 클라이언트가 서버에게 '클라이언트 헬로' 메시지를 보낼 때, 이 메시지에는 클라이언트가 지원하는 사이퍼 슈트 목록이 포함됩니다.
서버는 "서버 헬로" 메시지를 클라이언트에게 보냅니다. 서버가 '서버 헬로' 메시지를 클라이언트에게 보낼 때, 서버는 클라이언트가 제안한 사이퍼 슈트 목록에서 선택합니다. 서버는 이 목록에서 자신이 지원하는 가장 높은 우선 순위의 사이퍼 슈트를 선택하며, 이 선택된 사이퍼 슈트는 '서버 헬로' 메시지에 포함되어 클라이언트에게 전달됩니다.
클라이언트는 전달 받은 인증서와 CA의 공캐키를 통해 인증서를 검증합니다. 사이퍼슈트 내의 가장 적합한 알고리즘을 사용해 대칭키를 암호화합니다.
이 후, 클라이언트와 서버는 세션에 사용할 암호화 된 대칭키를 교환합니다.
이제부터 보안된 연결을 통해 데이터를 주고받을 수 있음을 서로에게 알립니다.
사이퍼 슈트란?

사이퍼 슈트(Cipher Suite)는 SSL/TLS 연결에서 사용되는 암호화 알고리즘의 집합을 의미합니다. 이는 데이터를 암호화하고 해독하는데 사용되는 키 교환 메커니즘, 대칭 암호화 알고리즘, 메시지 인증 코드, 그리고 필요한 경우 비대칭 암호화 알고리즘을 포함합니다.

사이퍼 슈트의 선택은 SSL/TLS 핸드셰이크 과정 중에서 발생합니다. 특히, 클라이언트와 서버가 '헬로' 메시지를 주고받는 단계에서 이루어집니다. 아래는 그 과정을 자세히 설명합니다:

클라이언트가 서버에게 '클라이언트 헬로' 메시지를 보낼 때, 이 메시지에는 클라이언트가 지원하는 사이퍼 슈트 목록이 포함됩니다. 이 목록은 클라이언트가 선호하는 순서대로 배열됩니다.
서버가 '서버 헬로' 메시지를 클라이언트에게 보낼 때, 서버는 클라이언트가 제안한 사이퍼 슈트 목록에서 선택합니다. 서버는 이 목록에서 자신이 지원하는 가장 높은 우선 순위의 사이퍼 슈트를 선택하며, 이 선택된 사이퍼 슈트는 '서버 헬로' 메시지에 포함되어 클라이언트에게 전달됩니다.
따라서, 사이퍼 슈트의 선택은 핸드셰이크 과정 중 클라이언트와 서버 간의 '헬로' 메시지를 주고받는 단계에서 결정되며, 이는 SSL/TLS 연결의 보안 수준을 결정하는 중요한 과정입니다.

디피 - 헬만 키 교환 알고리즘

→ 디피-헬만 키 교환 알고리즘(Diffie-Hellman key exchange)은 두 사용자가 공개적으로 접근 가능한 통신 채널을 통해 서로 비밀 공유 키를 생성하고 교환하는 방법입니다. 이 알고리즘은 1976년에 휘트필드 디피와 마틴 헬만에 의해 처음 개발되었습니다.

이 알고리즘의 주요 이점 중 하나는 실제 비밀 키를 직접 전송하지 않고, 서로 다른 두 개의 키를 이용하여 비밀 키를 생성하고 이를 공유한다는 것입니다. 이 방식으로 인해, 중간자 공격(man-in-the-middle attack)에 대한 취약성을 줄일 수 있습니다.

디피-헬만 키 교환 알고리즘의 기본적인 작동 방식은 다음과 같습니다:

먼저, 두 사용자는 공개적으로 알려진 두 개의 큰 숫자를 선택합니다. 이 두 숫자는 공개 키이며, 대개 이 둘 중 하나는 소수(prime number)입니다.
각 사용자는 그 후에 무작위로 비밀 수를 선택하고, 이를 비밀 키로 사용합니다.
이후 각 사용자는 비밀 키와 공개 키를 결합하여 또 다른 공개 키를 생성합니다. 이 생성된 공개 키는 공개적으로 다른 사용자에게 전송됩니다.
각 사용자는 받은 다른 사용자의 공개 키와 자신의 비밀 키를 결합하여 공유 비밀 키를 생성합니다. 이렇게 생성된 비밀 키는 두 사용자가 생성한 공유 비밀 키가 동일하다는 것을 보장합니다.
이 알고리즘의 핵심적인 부분은, 비밀 키는 외부에 노출되지 않으며, 공개 키만을 사용하여 공유 비밀 키를 생성한다는 것입니다. 그 결과, 이 알고리즘은 외부의 공격자가 공개 키만을 가지고 공유 비밀 키를 알아내는 것은 매우 어렵게 만듭니다. 이는 큰 숫자를 인수분해하는 것이 컴퓨팅적으로 어렵다는 수학적인 속성에 기반합니다.

디피-헬만 키 교환 알고리즘은 SSL/TLS와 같은 보안 프로토콜에서 널리 사용되어, 클라이언트와 서버 간에 비밀 키를 안전하게 교환하는 데 사용됩니다.